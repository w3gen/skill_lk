(function($){$(document).ready(function(){var user_id=parseInt(gamipress_events.user_id);var post_id=parseInt(gamipress_events.post_id);gamipress_track_visit(user_id,post_id)});function gamipress_track_visit(user_id,post_id){if(user_id===0){return}
if(gamipress_is_post_visited(post_id)){return}
gamipress_add_post_visited(post_id);$.ajax({url:gamipress_events.ajaxurl,type:'POST',data:{action:'gamipress_track_visit',nonce:gamipress_events.nonce,user_id:user_id,post_id:post_id},success:function(response){if(gamipress_events.debug_mode){console.log(response)}}}).fail(function(response){if(gamipress_events.debug_mode){console.log(response)}})}
function gamipress_is_post_visited(post_id){var posts_visited=gamipress_get_posts_visited();return posts_visited.includes(post_id)}
function gamipress_get_posts_visited(){var posts_visited=[];if(window.localStorage){var posts_cache_date=window.localStorage.getItem('gamipress_posts_visited_date');if(posts_cache_date!==gamipress_events.server_date){window.localStorage.removeItem('gamipress_posts_visited');window.localStorage.setItem('gamipress_posts_visited_date',gamipress_events.server_date)}else{var posts_cached=window.localStorage.getItem('gamipress_posts_visited');if(posts_cached){var posts_array=posts_cached.split(',');for(var i=0;i<posts_array.length;i++){var post_id=parseInt(posts_array[i]);if(!isNaN(post_id)&&!posts_visited.includes(post_id)){posts_visited[posts_visited.length]=post_id}}}}}
return posts_visited}
function gamipress_add_post_visited(post_id){if(window.localStorage){var posts_cached=window.localStorage.getItem('gamipress_posts_visited');if(!posts_cached){posts_cached=''}
var posts_visited=posts_cached.split(',');posts_visited.push(post_id);window.localStorage.setItem('gamipress_posts_visited',posts_visited.join(','))}}})(jQuery)